<!DOCTYPE html>
<html lang="en" class="scroll-smooth">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Set New Password - Gravity Club LPU</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
  <script src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    @keyframes float {
      0% {
        transform: translateY(0px);
      }
      50% {
        transform: translateY(-10px);
      }
      100% {
        transform: translateY(0px);
      }
    }

    .floating {
      animation: float 6s ease-in-out infinite;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .animate-fadeIn {
      animation: fadeIn 1s ease-out forwards;
    }

    /* Parallax scrolling background */
    @keyframes parallaxBackground {
      0% {
        background-position: 100% 0;
      }
      100% {
        background-position: 0% 0;
      }
    }

    body {
      background-image: url('Images/spacebackground.png');
      background-size: auto 100%;
      background-position: center;
      background-attachment: fixed;
      background-repeat: repeat-x;
      animation: parallaxBackground 60s linear infinite;
      min-height: 100vh;
      margin: 0;
    }
  .js-login-btn, .js-profile-icon, .js-logout-btn {
    display: none !important;
  }
  </style>

   <script>
  window.addEventListener("DOMContentLoaded", async () => {
    try {
      const { loggedIn } = await fetch("/session-info").then(r => r.json());

document.querySelectorAll(".js-login-btn").forEach(el => {
  el.style.setProperty("display", loggedIn ? "none" : "block", "important");
});

document.querySelectorAll(".js-profile-icon").forEach(el => {
  el.style.setProperty("display", loggedIn ? "block" : "none", "important");
});

document.querySelectorAll(".js-logout-btn").forEach(el => {
  el.style.setProperty("display", loggedIn ? "block" : "none", "important");
});

    } catch (err) {
      console.error(err);
    }
  });
</script>
  <script>
  window.addEventListener("DOMContentLoaded", async () => {
    try {
      const res = await fetch("/session-info");
      const data = await res.json();

      if (data.loggedIn && data.user && data.user.name) {
        const name = data.user.name.trim();
        const nameParts = name.split(" ");
        let initials = nameParts[0][0];
        if (nameParts.length > 1) initials += nameParts[nameParts.length - 1][0];

        document.getElementById("profileInitials").textContent = initials.toUpperCase();
        document.querySelector(".js-profile-icon").classList.remove("hidden");
      }
    } catch (err) {
      console.error("Error fetching session info", err);
    }
  });
</script>
</head>

<body class="bg-[#000000] text-[#D4D4D8] relative overflow-x-hidden">
     <nav class="bg-[#000000]/70 backdrop-blur-md sticky top-0 z-50 border-b border-[#6B21A8]/50 w-full">
    <div class="w-full px-4 py-3 flex justify-between items-center">
      <!-- Logo -->
      <div class="flex-shrink-0">
        <img src="Images/mainlogo.png" alt="Gravity Logo"
             class="h-16 w-auto hover:scale-105 transition-transform duration-300">
      </div>

      <!-- Desktop Links -->
      <ul class="hidden md:flex items-center gap-4 font-medium text-white mr-4">
        <li><a href="index.html" class="px-3 py-2 hover:text-[#A855F7] transition duration-300
             relative after:content-[''] after:absolute after:bottom-0 after:left-0 after:w-0 after:h-0.5
             after:bg-[#A855F7] after:transition-all after:duration-300 hover:after:w-full">Home</a>
        </li>
        <li class="relative group">
          <a href="#events" class="px-3 py-2 hover:text-[#A855F7] transition duration-300 flex items-center
             relative after:content-[''] after:absolute after:bottom-0 after:left-0 after:w-0 after:h-0.5
             after:bg-[#A855F7] after:transition-all after:duration-300 hover:after:w-full">
            Events <span class="ml-1 transform group-hover:rotate-180 transition duration-200">▼</span>
          </a>
          <ul class="absolute left-0 mt-2 w-48 bg-[#000000]/95 rounded-lg shadow-lg py-1
                     opacity-0 invisible group-hover:opacity-100 group-hover:visible
                     transition-all duration-300 border border-[#6B21A8]/30">
            <li><a href="ongoing.html" class="block px-4 py-2 hover:bg-[#6B21A8]/50 hover:pl-6 transition-all duration-200">Ongoing</a></li>
            <li><a href="upcoming.html" class="block px-4 py-2 hover:bg-[#6B21A8]/50 hover:pl-6 transition-all duration-200">Upcoming</a></li>
            <li><a href="archive.html"  class="block px-4 py-2 hover:bg-[#6B21A8]/50 hover:pl-6 transition-all duration-200">Archive</a></li>
          </ul>
        </li>
        <li><a href="team.html"    class="px-3 py-2 hover:text-[#A855F7] transition duration-300 relative after:content-['']
             after:absolute after:bottom-0 after:left-0 after:w-0 after:h-0.5 after:bg-[#A855F7] after:transition-all
             after:duration-300 hover:after:w-full">Team</a></li>
        <li><a href="gallery.html" class="px-3 py-2 hover:text-[#A855F7] transition duration-300 relative after:content-['']
             after:absolute after:bottom-0 after:left-0 after:w-0 after:h-0.5 after:bg-[#A855F7] after:transition-all
             after:duration-300 hover:after:w-full">Gallery</a></li>
        <li><a href="about.html"   class="px-3 py-2 hover:text-[#A855F7] transition duration-300 relative after:content-['']
             after:absolute after:bottom-0 after:left-0 after:w-0 after:h-0.5 after:bg-[#A855F7] after:transition-all
             after:duration-300 hover:after:w-full">About</a></li>
        <li><a href="contact.html" class="px-3 py-2 hover:text-[#A855F7] transition duration-300 relative after:content-['']
             after:absolute after:bottom-0 after:left-0 after:w-0 after:h-0.5 after:bg-[#A855F7] after:transition-all
             after:duration-300 hover:after:w-full">Contact Us</a></li>
      </ul>

      <!-- Right-side Controls -->
      <div class="flex items-center gap-3">
        <!-- Desktop Login (shown when loggedOut) -->
        <a href="/login"
           class="js-login-btn hidden md:block px-3 py-2 bg-gradient-to-r from-[#7C3AED] to-[#3B82F6]
                  rounded-lg font-medium text-white hover:shadow-lg hover:shadow-[#7C3AED]/20
                  transition duration-300">
          Login/Signup
        </a>

        <!-- Profile Icon (shown when loggedIn) -->
        <a id="profileIcon" href="/profile" class="js-profile-icon hidden md:block ml-6">
  <div id="profileInitials" class="w-8 h-8 rounded-full bg-blue-600 text-white flex items-center justify-center font-semibold text-sm">
    <!-- Initials will go here -->
  </div>
</a>


        <!-- Logout (shown when loggedIn) -->
        <a href="/logout"
           class="js-logout-btn block px-3 py-2 bg-gradient-to-r from-[#7C3AED] to-[#3B82F6]
                  rounded-lg font-medium text-white hover:shadow-lg hover:shadow-[#7C3AED]/20
                  transition duration-300">
          Logout
        </a>

        <!-- Mobile menu toggle -->
        <button class="md:hidden text-2xl text-white hover:text-[#A855F7] transition-colors duration-200"
                onclick="toggleMenu()" aria-label="Toggle menu">
          ☰
        </button>
      </div>
    </div>

    <!-- Mobile Menu -->
    <div id="mobileMenu" class="hidden md:hidden bg-[#000000]/95 px-5 py-3 space-y-3 font-medium">
      <a href="index.html" class="block px-3 py-2 hover:bg-[#6B21A8]/50 rounded transition duration-200">Home</a>
      <div class="px-3 py-2">
        <div class="flex items-center text-white mb-1">Events</div>
        <div class="ml-4 space-y-2 mt-2">
          <a href="ongoing.html"  class="block px-3 py-1 hover:bg-[#6B21A8]/50 rounded text-sm transition duration-200">Ongoing</a>
          <a href="upcoming.html" class="block px-3 py-1 hover:bg-[#6B21A8]/50 rounded text-sm transition duration-200">Upcoming</a>
          <a href="archive.html"  class="block px-3 py-1 hover:bg-[#6B21A8]/50 rounded text-sm transition duration-200">Archive</a>
        </div>
      </div>
      <a href="team.html"    class="block px-3 py-2 hover:bg-[#6B21A8]/50 rounded transition duration-200">Team</a>
      <a href="gallery.html" class="block px-3 py-2 hover:bg-[#6B21A8]/50 rounded transition duration-200">Gallery</a>
      <a href="about.html"   class="block px-3 py-2 hover:bg-[#6B21A8]/50 rounded transition duration-200">About</a>
      <a href="contact.html" class="block px-3 py-2 hover:bg-[#6B21A8]/50 rounded transition duration-200">Contact Us</a>

      <!-- Mobile Login (when loggedOut) -->
      <a id="loginBtn" href="/login"
         class="js-login-btn block px-3 py-2 bg-gradient-to-r from-[#7C3AED] to-[#3B82F6]
                rounded-lg font-medium text-white hover:shadow-lg hover:shadow-[#7C3AED]/20
                transition duration-300">
        Login/Signup
      </a>

      <!-- Mobile Profile Icon (when loggedIn) -->
      <a id="profileIconMobile" href="/profile" class="js-profile-icon" style="display: none;">
        <img src="/images/user-icon.png" alt="Profile" class="w-8 h-8 rounded-full mt-2">
      </a>
    </div>
  </nav>
<!-- Centered Wrapper -->
<div class="h-100 flex items-center justify-center ">
  <section class="w-full max-w-md px-6 py-12 animate-fadeIn">
    <div class="bg-[#000000]/70 backdrop-blur-lg rounded-xl p-8 border border-[#6B21A8]/50 shadow-lg shadow-[#6B21A8]/20">
      <div class="text-center mb-8">
        <img src="Images/mainlogo.png" alt="Gravity Logo" class="h-20 mx-auto mb-4 floating">
        <h2 class="text-2xl font-bold text-white mb-2">PROFILE DASHBOARD</h2>
      </div>

      <form action="/updatedashboard" method="post">
        <div class="mb-4">
          <label class="block text-sm font-medium text-[#D4D4D8] mb-2">Full Name</label>
          <input type="text" name="full_name" id="name" readonly
            class="w-full px-4 py-3 bg-[#1A0B3A]/50 border border-[#6B21A8]/30 rounded-lg focus:ring-2 focus:ring-[#A855F7] focus:border-transparent text-white placeholder-[#6B7280]">
        </div>

        <div class="mb-4">
          <label class="block text-sm font-medium text-[#D4D4D8] mb-2">Registration No</label>
          <input type="text" name="registration_no"  id="reg_no" readonly
            class="w-full px-4 py-3 bg-[#1A0B3A]/50 border border-[#6B21A8]/30 rounded-lg focus:ring-2 focus:ring-[#A855F7] focus:border-transparent text-white placeholder-[#6B7280]">
        </div>

        <div class="mb-4">
          <label class="block text-sm font-medium text-[#D4D4D8] mb-2">Email</label>
          <input type="email" name="email" id="email"
            class="w-full px-4 py-3 bg-[#1A0B3A]/50 border border-[#6B21A8]/30 rounded-lg focus:ring-2 focus:ring-[#A855F7] focus:border-transparent text-white placeholder-[#6B7280]">
        </div>

        <div class="mb-4">
          <label class="block text-sm font-medium text-[#D4D4D8] mb-2">Academic Year</label>
          <select name="academic_year" required id="academic_year"
            class="w-full px-4 py-3 bg-[#1A0B3A]/50 border border-[#6B21A8]/30 rounded-lg focus:ring-2 focus:ring-[#A855F7] focus:border-transparent text-white placeholder-[#6B7280]">
            <option value="" selected>Select your year</option>
            <option value="1st Year">1st Year</option>
            <option value="2nd Year">2nd Year</option>
            <option value="3rd Year">3rd Year</option>
            <option value="4th Year">4th Year</option>
          </select>
        </div>

        <div class="mb-4">
          <label class="block text-sm font-medium text-[#D4D4D8] mb-2">Phone No</label>
          <input type="text" name="phone_no" id="phone_no" readonly
            class="w-full px-4 py-3 bg-[#1A0B3A]/50 border border-[#6B21A8]/30 rounded-lg focus:ring-2 focus:ring-[#A855F7] focus:border-transparent text-white placeholder-[#6B7280]">
        </div>

        <button type="submit"
          class="w-full px-6 py-3 bg-gradient-to-r from-[#7C3AED] to-[#3B82F6] rounded-lg font-medium text-white hover:from-[#6D28D9] hover:to-[#2563EB] transition-all duration-300 hover:shadow-lg hover:shadow-[#7C3AED]/30">
          Update Details
        </button>
      </form>
    </div>
  </section>
</div>


  <script>
    window.addEventListener("DOMContentLoaded", async () => {
      try {
        const res = await fetch("/session-info");
        const data = await res.json();

        if (data.toast) {
          Toastify({
            text: data.toast,
            duration: 3000,
            gravity: "top",
            position: "center",
            style: {
              background: "linear-gradient(to right, #7C3AED, #3B82F6)",
              color: "#fff"
            }
          }).showToast();
        }
      } catch (err) {
        console.error("Error fetching session-info:", err);
      }
    });
  </script>
  
<script>
  window.addEventListener('DOMContentLoaded', async () => {
    try {
      const res = await fetch('/api/user-info');
      const data = await res.json();
      console.log(data);
      
      if (res.ok) {
      document.getElementById('name').value = data.name;
document.getElementById('reg_no').value = data.reg_no;
document.getElementById('email').value = data.email;
document.getElementById('phone_no').value = data.phone_no;
document.getElementById('academic_year').value = data.academic_year;
      } else {
        console.error("Error fetching user info", data.error);
      }
    } catch (err) {
      console.error("Fetch failed", err);
    }
  });
</script>

  
</body>
</html>